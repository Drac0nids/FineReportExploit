package CNVD201804757

import (
	"regexp"
	"strings"
)

func GetUserAndPass(data string) (string, string) {
	expr1 := `<rootManagerName>
\S+</rootManagerName>`
	expr2 := `<rootManagerPassword>
\S+</rootManagerPassword>`
	regexp1, _ := regexp.Compile(expr1)
	User := regexp1.FindString(data)
	User = strings.Replace(User, "<rootManagerName>", "", -1)
	User = strings.Replace(User, "</rootManagerName>", "", -1)
	User = strings.Replace(User, "<![CDATA[", "", -1)
	User = strings.Replace(User, "]]>", "", -1)
	User = strings.Replace(User, "\n", "", -1)
	User = strings.Replace(User, "\r", "", -1)

	regexp2, _ := regexp.Compile(expr2)
	Pass := regexp2.FindString(data)
	Pass = strings.Replace(Pass, "<rootManagerPassword>", "", -1)
	Pass = strings.Replace(Pass, "</rootManagerPassword>", "", -1)
	Pass = strings.Replace(Pass, "<![CDATA[", "", -1)
	Pass = strings.Replace(Pass, "]]>", "", -1)
	Pass = strings.Replace(Pass, "\n", "", -1)
	Pass = strings.Replace(Pass, "\r", "", -1)

	Pass = DecPass(Pass)
	return User, Pass

}
